COPY PART FROM "./tbl/part.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM PART) TO "parquet/part" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS PART CASCADE;
DROP VIEW IF EXISTS PART CASCADE;
CREATE VIEW PART AS (SELECT * FROM "./parquet/part/*.parquet");

COPY SUPPLIER FROM "./tbl/supplier.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM SUPPLIER) TO "parquet/supplier" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS SUPPLIER CASCADE;
DROP VIEW IF EXISTS SUPPLIER CASCADE;
CREATE VIEW SUPPLIER AS (SELECT * FROM "./parquet/supplier/*.parquet");

COPY PARTSUPP FROM "./tbl/partsupp.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM PARTSUPP) TO "parquet/partsupp" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS PARTSUPP CASCADE;
DROP VIEW IF EXISTS PARTSUPP CASCADE;
CREATE VIEW PARTSUPP AS (SELECT * FROM "./parquet/partsupp/*.parquet");

COPY CUSTOMER FROM "./tbl/customer.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM CUSTOMER) TO "parquet/customer" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS CUSTOMER CASCADE;
DROP VIEW IF EXISTS CUSTOMER CASCADE;
CREATE VIEW CUSTOMER AS (SELECT * FROM "./parquet/customer/*.parquet");

COPY ORDERS FROM "./tbl/orders.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM ORDERS) TO "parquet/orders" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS ORDERS CASCADE;
DROP VIEW IF EXISTS ORDERS CASCADE;
CREATE VIEW ORDERS AS (SELECT * FROM "./parquet/orders/*.parquet");

COPY LINEITEM FROM "./tbl/lineitem.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM LINEITEM) TO "parquet/lineitem" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS LINEITEM CASCADE;
DROP VIEW IF EXISTS LINEITEM CASCADE;
CREATE VIEW LINEITEM AS (SELECT * FROM "./parquet/lineitem/*.parquet");

COPY NATION FROM "./tbl/nation.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM NATION) TO "parquet/nation" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS NATION CASCADE;
DROP VIEW IF EXISTS NATION CASCADE;
CREATE VIEW NATION AS (SELECT * FROM "./parquet/nation/*.parquet");

COPY REGION FROM "./tbl/region.tbl" WITH (DELIMITER "|");
COPY (SELECT * FROM REGION) TO "parquet/region" (FORMAT "parquet", COMPRESSION "zstd", FILE_SIZE_BYTES 104857600);
DROP TABLE IF EXISTS REGION CASCADE;
DROP VIEW IF EXISTS REGION CASCADE;
CREATE VIEW REGION AS (SELECT * FROM "./parquet/region/*.parquet");
